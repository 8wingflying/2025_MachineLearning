## è¼¸å…¥ä¸€å€‹è‚¡ç¥¨æ¸…å–®ï¼Œç¨‹å¼è‡ªå‹•è·‘ä¸€éï¼Œåˆ—å‡ºä»Šå¤©å‡ºç¾ã€Œä¸Šæ¼²è¶…é3%ã€çš„æ‰€æœ‰è‚¡ç¥¨å¾é«˜åˆ°åº•
```python
import yfinance as yf
import pandas as pd

# ==========================================
# 1. è¨­å®šç›£æ§æ¸…å–®
# ==========================================
# æ‚¨å¯ä»¥æ··åˆç¾è‚¡èˆ‡å°è‚¡ (å°è‚¡è«‹åŠ  .TW)
# é€™è£¡æ”¾å…¥ä¸€äº›æ³¢å‹•è¼ƒå¤§çš„ç§‘æŠ€è‚¡ä½œç‚ºç¤ºç¯„
WATCH_LIST = [
    "NVDA", "TSLA", "AMD", "META", "AMZN", "GOOGL", "MSFT", "PLTR", "COIN", "MSTR", # ç¾è‚¡
    "2330.TW", "2454.TW", "2603.TW", "3035.TW", "3008.TW", "2382.TW", "3231.TW"     # å°è‚¡
]

def get_stock_name(ticker):
    """æ ¹æ“šè‚¡ç¥¨ä»£è™Ÿå–å¾—è‚¡ç¥¨åç¨±"""
    try:
        info = yf.Ticker(ticker).info
        if 'longName' in info: # ç¾è‚¡é€šå¸¸æœ‰ longName
            return info['longName']
        elif 'shortName' in info: # æœ‰äº›å°è‚¡å¯èƒ½æ˜¯ shortName
            return info['shortName']
        else:
            return ticker
    except Exception:
        return ticker

def get_top_gainers(stock_list, threshold=5.0):
    print(f"æ­£åœ¨æƒæ {len(stock_list)} æª”è‚¡ç¥¨çš„æœ€æ–°è¡Œæƒ…...\n")

    # æ‰¹é‡ä¸‹è¼‰æ•¸æ“š (period='5d' ç¢ºä¿æœ‰è¶³å¤ æ•¸æ“šè¨ˆç®—æ¼²è·Œï¼Œé›–ç„¶æˆ‘å€‘åªéœ€è¦æœ€å¾Œå…©å¤©)
    # group_by='ticker' è®“è³‡æ–™çµæ§‹æ›´å¥½è™•ç†
    try:
        data = yf.download(stock_list, period="5d", group_by='ticker', progress=False)
    except Exception as e:
        print(f"ä¸‹è¼‰æ•¸æ“šæ™‚ç™¼ç”ŸéŒ¯èª¤: {e}")
        return []

    results = []

    for ticker in stock_list:
        try:
            # è™•ç†å–®ä¸€è‚¡ç¥¨æ•¸æ“š (å¦‚æœä¸‹è¼‰å¤±æ•—ï¼Œè©²æ¬„ä½å¯èƒ½ç‚ºç©º)
            df = data[ticker]

            # ç¢ºä¿åªæœ‰åŒ…å« 'Close' çš„æ•¸æ“šä¸”éç©º
            if df.empty or 'Close' not in df.columns:
                continue

            # ç§»é™¤ç©ºå€¼åˆ—
            df = df.dropna(subset=['Close'])

            if len(df) < 2:
                continue

            # å–å¾—æœ€æ–°åƒ¹èˆ‡æ˜¨æ—¥æ”¶ç›¤åƒ¹
            # iloc[-1] æ˜¯æœ€æ–°ä¸€ç­† (å¯èƒ½æ˜¯ç›¤ä¸­æˆ–å‰›æ”¶ç›¤), iloc[-2] æ˜¯å‰ä¸€å¤©æ”¶ç›¤
            last_price = df['Close'].iloc[-1]
            prev_close = df['Close'].iloc[-2]

            # è¨ˆç®—æ¼²è·Œå¹…
            change_pct = ((last_price - prev_close) / prev_close) * 100

            # å–å¾—è‚¡ç¥¨åç¨±
            stock_name = get_stock_name(ticker)

            # ç¯©é¸æ¢ä»¶ï¼šæ¼²å¹…å¤§æ–¼è¨­å®šé–€æª» (ä¾‹å¦‚ 5%)
            if change_pct > threshold:
                results.append({
                    'ticker': ticker,
                    'name': stock_name,
                    'price': last_price,
                    'prev_close': prev_close,
                    'change_pct': change_pct
                })

        except KeyError:
            # æŸäº›è‚¡ç¥¨å¯èƒ½å› ç‚ºä¸‹å¸‚æˆ–ä»£è™ŸéŒ¯èª¤å°è‡´ Key Errorï¼Œç›´æ¥è·³é
            continue
        except Exception as e:
            # å…¶ä»–éŒ¯èª¤
            continue

    # æ’åºï¼šä¾ç…§æ¼²è·Œå¹… (change_pct) ç”±å¤§åˆ°å° (reverse=True)
    sorted_results = sorted(results, key=lambda x: x['change_pct'], reverse=True)

    return sorted_results

# ==========================================
# ä¸»ç¨‹å¼åŸ·è¡Œ
# ==========================================
if __name__ == "__main__":
    # è¨­å®šæ¼²å¹…é–€æª» (é€™è£¡è¨­ç‚º 3%)
    THRESHOLD = 3.0

    top_stocks = get_top_gainers(WATCH_LIST, threshold=THRESHOLD)

    print("-" * 50)
    print(f"ğŸš€ ä»Šæ—¥æ¼²å¹…è¶…é {THRESHOLD}% çš„å¼·å‹¢è‚¡ (ç”±é«˜åˆ°ä½)")
    print("-" * 50)
    print(f"{'ä»£è™Ÿ':<10} {'åç¨±':<15} {'ç¾åƒ¹':<10} {'æ¼²è·Œå¹…%':<10} {'ç‹€æ…‹'}")
    print("-" * 50)

    if top_stocks:
        for stock in top_stocks:
            # æ ¹æ“šæ¼²å¹…å¤§å°åŠ ä¸Šä¸åŒçš„ emoji å¼·åº¦
            icon = "ğŸ”¥" if stock['change_pct'] > 10 else "ğŸ“ˆ"

            print(f"{stock['ticker']:<10} {stock['name']:<15} {stock['price']:<10.2f} +{stock['change_pct']:<9.2f}%  {icon}")
    else:
        print("ä»Šæ—¥æ¸…å–®ä¸­æ²’æœ‰è‚¡ç¥¨æ¼²å¹…è¶…é 5%ã€‚")

    print("-" * 50)
```
